(function(){"use strict";!function(a,b){function h(a){return a.forEach||(a.forEach=function(a){var b,c=this.length;for(b=0;c>b;b++)a(this[b],b,c)}),a}var f,g,c=Float32Array,d=Math.sqrt,e=function(a){return Math.pow(a,2)};a.isComplexArray=f=function(a){return a!==b&&a.hasOwnProperty!==b&&a.hasOwnProperty("real")&&a.hasOwnProperty("imag")},a.ComplexArray=g=function(a,b){f(a)?(this.ArrayType=a.ArrayType,this.real=new this.ArrayType(a.real),this.imag=new this.ArrayType(a.imag)):(this.ArrayType=b||c,this.real=new this.ArrayType(a),this.imag=new this.ArrayType(this.real.length)),this.length=this.real.length},g.prototype.toString=function(){var a=[];return this.forEach(function(b){a.push("("+b.real.toFixed(2)+","+b.imag.toFixed(2)+")")}),"["+a.join(",")+"]"},g.prototype.map=function(a){var b,c=this.length,d={};for(b=0;c>b;b++)d.real=this.real[b],d.imag=this.imag[b],a(d,b,c),this.real[b]=d.real,this.imag[b]=d.imag;return this},g.prototype.forEach=function(a){var b,c=this.length,d={};for(b=0;c>b;b++)d.real=this.real[b],d.imag=this.imag[b],a(d,b,c)},g.prototype.conjugate=function(){return new g(this).map(function(a){a.imag*=-1})},g.prototype.magnitude=function(){var a=new this.ArrayType(this.length);return this.forEach(function(b,c){a[c]=d(e(b.real)+e(b.imag))}),h(a)}}("undefined"==typeof exports&&(this.complex_array={})||exports),!function(a,b){function i(a){return b.isComplexArray(a)&&a||new c(a)}function j(a,b){var c=a.length;return c&c-1?k(a,b):l(a,b)}function k(a,b){var i,k,l,m,n,p,q,r,s,t,u,v,w,x,e=a.length;if(1===e)return a;for(l=new c(e,a.ArrayType),r=o(e),s=e/r,t=1/f(r),u=new c(s,a.ArrayType),k=0;r>k;k++){for(i=0;s>i;i++)u.real[i]=a.real[i*r+k],u.imag[i]=a.imag[i*r+k];for(s>1&&(u=j(u,b)),p=g(2*d*k/e),q=(b?-1:1)*h(2*d*k/e),m=1,n=0,i=0;e>i;i++)w=u.real[i%s],x=u.imag[i%s],l.real[i]+=m*w-n*x,l.imag[i]+=m*x+n*w,v=m*p-n*q,n=m*q+n*p,m=v}for(i=0;e>i;i++)a.real[i]=t*l.real[i],a.imag[i]=t*l.imag[i];return a}function l(a,b){var f,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,c=a.length;for(j=n(a),k=j.real,l=j.imag,y=1;c>y;){for(p=g(d/y),q=(b?-1:1)*h(d/y),f=0;c/(2*y)>f;f++)for(m=1,o=0,i=0;y>i;i++)s=2*f*y+i,t=s+y,u=k[s],v=l[s],w=m*k[t]-o*l[t],x=o*k[t]+m*l[t],k[s]=e*(u+w),l[s]=e*(v+x),k[t]=e*(u-w),l[t]=e*(v-x),r=m*p-o*q,o=m*q+o*p,m=r;y<<=1}return j}function m(a,b){for(var c=0;b>1;)c<<=1,c+=1&a,a>>=1,b>>=1;return c}function n(a){var d,e,b=a.length,c={};for(e=0;b>e;e++){var f=m(e,b);c.hasOwnProperty(e)||c.hasOwnProperty(f)||(d=a.real[f],a.real[f]=a.real[e],a.real[e]=d,d=a.imag[f],a.imag[f]=a.imag[e],a.imag[e]=d,c[e]=c[f]=!0)}return a}function o(a){for(var b=3,c=f(a);c>=b;){if(0===a%b)return b;b+=2}return a}var c=b.ComplexArray,d=Math.PI,e=Math.SQRT1_2,f=Math.sqrt,g=Math.cos,h=Math.sin;c.prototype.FFT=function(){return j(this,!1)},a.FFT=function(a){return i(a).FFT()},c.prototype.InvFFT=function(){return j(this,!0)},a.InvFFT=function(a){return i(a).InvFFT()},c.prototype.frequencyMap=function(a){return this.FFT().map(a).InvFFT()},a.frequencyMap=function(a,b){return i(a).frequencyMap(b)}}("undefined"==typeof exports&&(this.fft={})||exports,"undefined"==typeof require&&this.complex_array||require("./complex_array")),!function(a,b){function d(a){var f,b=a.length/4,c=new Uint8ClampedArray(b),d=new Uint8ClampedArray(b),e=new Uint8ClampedArray(b);for(f=0;b>f;f++)c[f]=a[4*f],d[f]=a[4*f+1],e[f]=a[4*f+2];return[c,d,e]}function e(a,b,d){var g,e=a.length,f=new c(4*e);for(g=0;e>g;g++)f.real[4*g]=a.real[g],f.imag[4*g]=a.imag[g],f.real[4*g+1]=b.real[g],f.imag[4*g+1]=b.imag[g],f.real[4*g+2]=d.real[g],f.imag[4*g+2]=d.imag[g];return f}function f(a,b,d,e){var f,g,h=e?"InvFFT":"FFT",i=new c(a.length,a.ArrayType),j=new c(b,a.ArrayType),k=new c(d,a.ArrayType);for(g=0;d>g;g++)j.map(function(c,d){c.real=a.real[d+g*b],c.imag=a.imag[d+g*b]}),j[h]().forEach(function(a,c){i.real[c+g*b]=a.real,i.imag[c+g*b]=a.imag});for(f=0;b>f;f++)k.map(function(a,c){a.real=i.real[f+c*b],a.imag=i.imag[f+c*b]}),k[h]().forEach(function(a,c){i.real[f+c*b]=a.real,i.imag[f+c*b]=a.imag});return i}var c=a.ComplexArray;b.FFTImageDataRGBA=function(a,b,g){var h=d(a);return e(f(new c(h[0],Float32Array),b,g),f(new c(h[1],Float32Array),b,g),f(new c(h[2],Float32Array),b,g))}}("undefined"==typeof require&&this.complex_array||require("./complex_array"),"undefined"==typeof require&&this.fft||require("./fft"))}());
